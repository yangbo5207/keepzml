1:"$Sreact.fragment"
2:I[51790,["7525","static/chunks/7525-411280bffc37a107.js","8173","static/chunks/8173-1aab990e083a60ce.js","5926","static/chunks/5926-2f921190ce1e6581.js","3974","static/chunks/3974-a1a1a9aca3315bf5.js","7177","static/chunks/app/layout-42df43a67d50e5c7.js"],"default"]
3:I[73974,["7525","static/chunks/7525-411280bffc37a107.js","8173","static/chunks/8173-1aab990e083a60ce.js","5926","static/chunks/5926-2f921190ce1e6581.js","3974","static/chunks/3974-a1a1a9aca3315bf5.js","7177","static/chunks/app/layout-42df43a67d50e5c7.js"],"default"]
4:I[15244,[],""]
5:I[43866,[],""]
6:I[14547,[],"ClientSegmentRoot"]
7:I[15422,["7525","static/chunks/7525-411280bffc37a107.js","8173","static/chunks/8173-1aab990e083a60ce.js","5926","static/chunks/5926-2f921190ce1e6581.js","3974","static/chunks/3974-a1a1a9aca3315bf5.js","5145","static/chunks/app/reactprinciple/layout-bd3d0323f2063f6d.js"],"default"]
9:I[98087,["8150","static/chunks/7cfd557f-0718c923d48595ad.js","7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","8173","static/chunks/8173-1aab990e083a60ce.js","3152","static/chunks/3152-e813ba8dd61cd947.js","8993","static/chunks/8993-54d112cc9d49de88.js","6253","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/layout-36b3fc35fe4ba52e.js"],"default"]
a:I[3731,["7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","5926","static/chunks/5926-2f921190ce1e6581.js","5495","static/chunks/5495-c9afbde98032192a.js","2756","static/chunks/2756-7b2130b3332992d3.js","8290","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/page-7b5586881a9328a2.js"],"default"]
e:I[40778,["7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","5926","static/chunks/5926-2f921190ce1e6581.js","5495","static/chunks/5495-c9afbde98032192a.js","2756","static/chunks/2756-7b2130b3332992d3.js","8290","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/page-7b5586881a9328a2.js"],"default"]
f:I[81924,["7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","5926","static/chunks/5926-2f921190ce1e6581.js","5495","static/chunks/5495-c9afbde98032192a.js","2756","static/chunks/2756-7b2130b3332992d3.js","8290","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/page-7b5586881a9328a2.js"],"default"]
11:I[86213,[],"OutletBoundary"]
13:I[86213,[],"MetadataBoundary"]
15:I[86213,[],"ViewportBoundary"]
17:I[34835,[],""]
:HL["/_next/static/media/569ce4b8f30dc480-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/d498c84e4ab246b3.css","style"]
:HL["/_next/static/css/ce43d802abe2c545.css","style"]
:HL["/_next/static/css/738174a5e4c964fb.css","style"]
:HL["/_next/static/css/0d51857a02fa9b46.css","style"]
:HL["/_next/static/css/72917e6cd0f02e77.css","style"]
0:{"P":null,"b":"om3xpIClmohhK3IVwkceI","p":"","c":["","reactprinciple","2.basecase"],"i":false,"f":[[["",{"children":["reactprinciple",{"children":["(1.concurrent)",{"children":["2.basecase",{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/d498c84e4ab246b3.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/ce43d802abe2c545.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/_next/static/css/738174a5e4c964fb.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","3",{"rel":"stylesheet","href":"/_next/static/css/0d51857a02fa9b46.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"zh","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","meta",null,{"charSet":"UTF-8"}],["$","link",null,{"href":"https://framerusercontent.com/images/YRd2KCq4G2aXNg15aHvl7AtcGQ.png","rel":"icon","media":"(prefers-color-scheme: light)"}],["$","link",null,{"rel":"stylesheet","href":"https://rsms.me/inter/inter.css"}],["$","link",null,{"rel":"stylesheet","href":"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css","integrity":"sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV","crossOrigin":"anonymous"}],["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1.0 maximum-scale=1, user-scalable=no"}],["$","meta",null,{"name":"mobile-web-app-capable","content":"yes"}],["$","meta",null,{"name":"apple-mobile-web-app-status-bar-style","content":"black-translucent"}]]}],["$","body",null,{"className":"__variable_4d318d __variable_ea5f4b antialiased","children":["$","$L2",null,{"children":[["$","$L3",null,{}],["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]]}]}]]}]]}],{"children":["reactprinciple",["$","$1","c",{"children":[null,["$","$L6",null,{"Component":"$7","slots":{"children":["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","reactprinciple","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@8"}]]}],{"children":["(1.concurrent)",["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","reactprinciple","children","(1.concurrent)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["2.basecase",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/72917e6cd0f02e77.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L9",null,{"children":["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","reactprinciple","children","(1.concurrent)","children","2.basecase","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]}]]}],{"children":["__PAGE__",["$","$1","c",{"children":[[["$","h3",null,{"id":"1基础案例","children":"1、基础案例"}],"\n",["$","p",null,{"children":["现在，我有一个任务，是往父元素中插入十万个子节点 ",["$","code",null,{"children":"<span>1</span>"}],"。普通的思考逻辑下，我们可以随便写这样一个函数来完成这个逻辑"]}],"\n",["$","$La",null,{}],"\n","$Lb","\n",["$","p",null,{"children":"大家点击按钮演示观察一下。"}],"\n",["$","p",null,{"children":"我们发现，当我们点击之后，页面上并不会立即显示插入的内容，而是会卡顿一会儿才会显示。"}],"\n",["$","p",null,{"children":["原因是因为我们在同步逻辑中发布了 ",["$","code",null,{"children":"插入十万个节点"}]," 的任务，",["$","strong",null,{"children":"长时间的 JavaScript 逻辑执行"}],"是造成卡顿的主要原因，除此之外，这样写的逻辑，浏览器会在一帧的时间内将这么多节点全部渲染完成，也会造成一点耗时。"]}],"\n",["$","h3",null,{"id":"1优化思路","children":"1、优化思路"}],"\n",["$","p",null,{"children":["为了优化这个问题。我们需要将任务进行拆分。把",["$","strong",null,{"children":"渲染十万个节点"}],"这个大的任务，拆分成",["$","strong",null,{"children":"十万个渲染一个节点"}],"的小任务"]}],"\n","$Lc","\n",["$","p",null,{"children":"然后将这个十万个任务，放入一个执行队列中执行"}],"\n","$Ld","\n",["$","p",null,{"children":"然后结合浏览器的刷新率，分批次的去执行这些被拆分的任务。"}],"\n",["$","p",null,{"children":"理想的结果就是，JS 执行一部分，然后渲染引擎渲染一部分。完成之后，JS 再继续执行，渲染引擎再渲染。通过这样时间分片的间隔执行方式，让用户感知不到卡顿的存在。"}],"\n",["$","$Le",null,{}],"\n",["$","p",null,{"children":"我们可以利用浏览器一帧渲染任务完成之后的空余时间来执行被拆分的 JS 任务。完整的代码如下"}],"\n",["$","$Lf",null,{}],"\n","$L10","\n",["$","p",null,{"children":"尝试演示效果，我们发现，一点击按钮，马上就有内容渲染出来。卡顿消失了。"}],"\n",["$","p",null,{"children":"我们额外在代码中记录了一个循环状态，用于展示整个大任务的渲染耗时。大家可以结合代码多多感受一下。"}]],null,["$","$L11",null,{"children":"$L12"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","-8YZwtI9AkMfWnG4xL72o",{"children":[["$","$L13",null,{"children":"$L14"}],["$","$L15",null,{"children":"$L16"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}]]}],false]],"m":"$undefined","G":["$17","$undefined"],"s":false,"S":true}
8:{}
18:I[34034,["7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","5926","static/chunks/5926-2f921190ce1e6581.js","5495","static/chunks/5495-c9afbde98032192a.js","2756","static/chunks/2756-7b2130b3332992d3.js","8290","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/page-7b5586881a9328a2.js"],"default"]
19:I[65470,["7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","5926","static/chunks/5926-2f921190ce1e6581.js","5495","static/chunks/5495-c9afbde98032192a.js","2756","static/chunks/2756-7b2130b3332992d3.js","8290","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/page-7b5586881a9328a2.js"],"CodeTabHeader"]
1a:I[65703,["7525","static/chunks/7525-411280bffc37a107.js","4320","static/chunks/4320-eb0b4108191194bc.js","5926","static/chunks/5926-2f921190ce1e6581.js","5495","static/chunks/5495-c9afbde98032192a.js","2756","static/chunks/2756-7b2130b3332992d3.js","8290","static/chunks/app/reactprinciple/(1.concurrent)/2.basecase/page-7b5586881a9328a2.js"],"CodeTabsInner"]
c:["$","div",null,{"className":"code-wrapper border my-4 border-gray-200 rounded overflow-hidden","children":[null,["$","div",null,{"className":"code-base typescript","children":[false,["$","pre",null,{"data-theme":"github-from-css","data-lang":"typescript","ref":"$undefined","data-ch":true,"children":["$","div",null,{"style":{"minWidth":"fit-content"},"children":[["$","div","1,1",{"style":{"borderLeft":"solid 2px transparent","borderLeftColor":"$undefined","backgroundColor":"$undefined"},"className":"flex","children":["$","div",null,{"className":"flex items-center","children":[["$","span",null,{"className":"line-number px-4 text-gray-400 text-xs select-none","children":["$","span",null,{"children":[1,["$","span",null,{"className":"invisible","children":""}]]}]}],["$","div",null,{"children":[["$","span","0",{"style":{"color":"var(--ch-7)"},"children":"function"}]," ",["$","span","2",{"style":{"color":"var(--ch-5)"},"children":"performWorkUnit"}],["$","span","3",{"style":{"color":"var(--ch-4)"},"children":"() {"}],"\n"],"className":"px-2 flex-1 flex-1 pl-2"}]]}]}],["$","div","2,2",{"style":{"borderLeft":"solid 2px transparent","borderLeftColor":"$undefined","backgroundColor":"$undefined"},"className":"flex","children":["$","div",null,{"className":"flex items-center","children":[["$","span",null,{"className":"line-number px-4 text-gray-400 text-xs select-none","children":["$","span",null,{"children":[2,["$","span",null,{"className":"invisible","children":""}]]}]}],["$","div",null,{"children":["  ",["$","span","1",{"style":{"color":"var(--ch-7)"},"children":"let"}]," ",["$","span","3",{"style":{"color":"var(--ch-4)"},"children":"span"}]," ",["$","span","5",{"style":{"color":"var(--ch-7)"},"children":"="}]," ",["$","span","7",{"style":{"color":"var(--ch-4)"},"children":"document."}],["$","span","8",{"style":{"color":"var(--ch-5)"},"children":"createElement"}],["$","span","9",{"style":{"color":"var(--ch-4)"},"children":"("}],["$","span","10",{"style":{"color":"var(--ch-8)"},"children":"'span'"}],["$","span","11",{"style":{"color":"var(--ch-4)"},"children":")"}],"\n"],"className":"px-2 flex-1 flex-1 pl-2"}]]}]}],["$","div","3,3",{"style":{"borderLeft":"solid 2px transparent","borderLeftColor":"$undefined","backgroundColor":"$undefined"},"className":"flex","children":["$","div",null,{"className":"flex items-center","children":[["$","span",null,{"className":"line-number px-4 text-gray-400 text-xs select-none","children":["$","span",null,{"children":[3,["$","span",null,{"className":"invisible","children":""}]]}]}],["$","div",null,{"children":["  ",["$","span","1",{"style":{"color":"var(--ch-4)"},"children":"span.innerText"}]," ",["$","span","3",{"style":{"color":"var(--ch-7)"},"children":"="}]," ",["$","span","5",{"style":{"color":"var(--ch-8)"},"children":"'1'"}],"\n"],"className":"px-2 flex-1 flex-1 pl-2"}]]}]}],["$","div","4,4",{"style":{"borderLeft":"solid 2px transparent","borderLeftColor":"$undefined","backgroundColor":"$undefined"},"className":"flex","children":["$","div",null,{"className":"flex items-center","children":[["$","span",null,{"className":"line-number px-4 text-gray-400 text-xs select-none","children":["$","span",null,{"children":[4,["$","span",null,{"className":"invisible","children":""}]]}]}],["$","div",null,{"children":["  ",["$","span","1",{"style":{"color":"var(--ch-4)"},"children":"container.current."}],["$","span","2",{"style":{"color":"var(--ch-5)"},"children":"appendChild"}],["$","span","3",{"style":{"color":"var(--ch-4)"},"children":"(span)"}],"\n"],"className":"px-2 flex-1 flex-1 pl-2"}]]}]}],["$","div","5,5",{"style":{"borderLeft":"solid 2px transparent","borderLeftColor":"$undefined","backgroundColor":"$undefined"},"className":"flex","children":["$","div",null,{"className":"flex items-center","children":[["$","span",null,{"className":"line-number px-4 text-gray-400 text-xs select-none","children":["$","span",null,{"children":[5,["$","span",null,{"className":"invisible","children":""}]]}]}],["$","div",null,{"children":[["$","span","0",{"style":{"color":"var(--ch-4)"},"children":"}"}]],"className":"px-2 flex-1 flex-1 pl-2"}]]}]}]]}]}]]}]]}]
d:["$","div",null,{"className":"code-wrapper border my-4 border-gray-200 rounded overflow-hidden","children":[null,["$","div",null,{"className":"code-base typescript","children":[false,["$","pre",null,{"data-theme":"github-from-css","data-lang":"typescript","ref":"$undefined","data-ch":true,"children":["$","div",null,{"style":{"minWidth":"fit-content"},"children":[["$","div","1,1",{"style":{"borderLeft":"solid 2px transparent","borderLeftColor":"$undefined","backgroundColor":"$undefined"},"className":"flex","children":["$","div",null,{"className":"flex items-center","children":[["$","span",null,{"className":"line-number px-4 text-gray-400 text-xs select-none","children":["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":14,"height":14,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-terminal","children":[["$","polyline","akl6gq",{"points":"4 17 10 11 4 5"}],["$","line","q2wloq",{"x1":"12","x2":"20","y1":"19","y2":"19"}],"$undefined"]}]}],["$","div",null,{"children":[["$","span","0",{"style":{"color":"var(--ch-7)"},"children":"const"}]," ",["$","span","2",{"style":{"color":"var(--ch-2)"},"children":"queue"}]," ",["$","span","4",{"style":{"color":"var(--ch-7)"},"children":"="}]," ",["$","span","6",{"style":{"color":"var(--ch-4)"},"children":"Array."}],["$","span","7",{"style":{"color":"var(--ch-5)"},"children":"from"}],["$","span","8",{"style":{"color":"var(--ch-4)"},"children":"({length:"}]," ",["$","span","10",{"style":{"color":"var(--ch-2)"},"children":"100000"}],["$","span","11",{"style":{"color":"var(--ch-4)"},"children":"}, ()"}]," ",["$","span","13",{"style":{"color":"var(--ch-7)"},"children":"=>"}]," ",["$","span","15",{"style":{"color":"var(--ch-4)"},"children":"performWorkUnit)"}]],"className":"px-2 flex-1 flex-1 pl-2"}]]}]}]]}]}]]}]]}]
b:["$","div",null,{"className":"code-tabs border rounded border-gray-200 overflow-hidden my-5","children":["$","$L18",null,{"children":[["$","$L19",null,{"tabs":[{"meta":"index.tsx -c","value":"import Button from '@/components/ui/button'\nimport { useRef, useState } from 'react'\n\nexport default function Counter() {\n  const container = useRef<any>(null)\n  const [loopRunning, setLoop] = useState(false)\n\n  // 长耗时任务\n  function expensiveTask() {\n    let i = 0\n    for (; i < 100000; i++) {\n      let span = document.createElement('span')\n      span.innerText = '1'\n      container.current.appendChild(span)\n    }\n  }\n\n  function __click() {\n    setLoop(true)\n    setTimeout(() => {\n      expensiveTask()\n    }, 100)\n  }\n\n  return (\n    <div className='space-y-4'>\n      <Button disabled={loopRunning} danger onClick={__click}>插入 100 万个子节点</Button>\n      <div ref={container} className='h-72 break-words overflow-y-scroll'></div>\n    </div>\n  )\n}","lang":"tsx"}]}],["$","$L1a",null,{"highlighteds":[{"meta":"index.tsx -c","value":"import Button from '@/components/ui/button'\nimport { useRef, useState } from 'react'\n\nexport default function Counter() {\n  const container = useRef<any>(null)\n  const [loopRunning, setLoop] = useState(false)\n\n  // 长耗时任务\n  function expensiveTask() {\n    let i = 0\n    for (; i < 100000; i++) {\n      let span = document.createElement('span')\n      span.innerText = '1'\n      container.current.appendChild(span)\n    }\n  }\n\n  function __click() {\n    setLoop(true)\n    setTimeout(() => {\n      expensiveTask()\n    }, 100)\n  }\n\n  return (\n    <div className='space-y-4'>\n      <Button disabled={loopRunning} danger onClick={__click}>插入 100 万个子节点</Button>\n      <div ref={container} className='h-72 break-words overflow-y-scroll'></div>\n    </div>\n  )\n}","lang":"tsx","code":"import Button from '@/components/ui/button'\nimport { useRef, useState } from 'react'\n\nexport default function Counter() {\n  const container = useRef<any>(null)\n  const [loopRunning, setLoop] = useState(false)\n\n  // 长耗时任务\n  function expensiveTask() {\n    let i = 0\n    for (; i < 100000; i++) {\n      let span = document.createElement('span')\n      span.innerText = '1'\n      container.current.appendChild(span)\n    }\n  }\n\n  function __click() {\n    setLoop(true)\n    setTimeout(() => {\n      expensiveTask()\n    }, 100)\n  }\n\n  return (\n    <div className='space-y-4'>\n      <Button disabled={loopRunning} danger onClick={__click}>插入 100 万个子节点</Button>\n      <div ref={container} className='h-72 break-words overflow-y-scroll'></div>\n    </div>\n  )\n}","tokens":[["import","var(--ch-7)"]," ",["Button","var(--ch-4)"]," ",["from","var(--ch-7)"]," ",["'@/components/ui/button'","var(--ch-8)"],"\n",["import","var(--ch-7)"]," ",["{ useRef, useState }","var(--ch-4)"]," ",["from","var(--ch-7)"]," ",["'react'","var(--ch-8)"],"\n\n",["export default function","var(--ch-7)"]," ",["Counter","var(--ch-5)"],["()","var(--ch-3)"]," ",["{","var(--ch-4)"],"\n  ",["const","var(--ch-7)"]," ",["container","var(--ch-2)"]," ",["=","var(--ch-7)"]," ",["useRef","var(--ch-5)"],["<","var(--ch-4)"],["any","var(--ch-2)"],[">(","var(--ch-4)"],["null","var(--ch-2)"],[")","var(--ch-4)"],"\n  ",["const","var(--ch-7)"]," ",["[","var(--ch-4)"],["loopRunning","var(--ch-2)"],[",","var(--ch-4)"]," ",["setLoop","var(--ch-2)"],["]","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["useState","var(--ch-5)"],["(","var(--ch-4)"],["false","var(--ch-2)"],[")","var(--ch-4)"],"\n\n  ",["// 长耗时任务","var(--ch-1)"],"\n  ",["function","var(--ch-7)"]," ",["expensiveTask","var(--ch-5)"],["() {","var(--ch-4)"],"\n    ",["let","var(--ch-7)"]," ",["i","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["0","var(--ch-2)"],"\n    ",["for","var(--ch-7)"]," ",["(; i","var(--ch-4)"]," ",["<","var(--ch-7)"]," ",["100000","var(--ch-2)"],["; i","var(--ch-4)"],["++","var(--ch-7)"],[") {","var(--ch-4)"],"\n      ",["let","var(--ch-7)"]," ",["span","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["document.","var(--ch-4)"],["createElement","var(--ch-5)"],["(","var(--ch-4)"],["'span'","var(--ch-8)"],[")","var(--ch-4)"],"\n      ",["span.innerText","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["'1'","var(--ch-8)"],"\n      ",["container.current.","var(--ch-4)"],["appendChild","var(--ch-5)"],["(span)","var(--ch-4)"],"\n    ",["}","var(--ch-4)"],"\n  ",["}","var(--ch-4)"],"\n\n  ",["function","var(--ch-7)"]," ",["__click","var(--ch-5)"],["() {","var(--ch-4)"],"\n    ",["setLoop","var(--ch-5)"],["(","var(--ch-4)"],["true","var(--ch-2)"],[")","var(--ch-4)"],"\n    ",["setTimeout","var(--ch-5)"],["(()","var(--ch-4)"]," ",["=>","var(--ch-7)"]," ",["{","var(--ch-4)"],"\n      ",["expensiveTask","var(--ch-5)"],["()","var(--ch-4)"],"\n    ",["},","var(--ch-4)"]," ",["100","var(--ch-2)"],[")","var(--ch-4)"],"\n  ",["}","var(--ch-4)"],"\n\n  ",["return","var(--ch-7)"]," ",["(","var(--ch-4)"],"\n    ",["<","var(--ch-4)"],["div","var(--ch-6)"]," ",["className","var(--ch-2)"],["=","var(--ch-7)"],["'space-y-4'","var(--ch-8)"],[">","var(--ch-4)"],"\n      ",["<","var(--ch-4)"],["Button","var(--ch-6)"]," ",["disabled","var(--ch-2)"],["={","var(--ch-7)"],["loopRunning","var(--ch-4)"],["}","var(--ch-7)"]," ",["danger onClick","var(--ch-2)"],["={","var(--ch-7)"],["__click","var(--ch-4)"],["}","var(--ch-7)"],[">插入 100 万个子节点</","var(--ch-4)"],["Button","var(--ch-6)"],[">","var(--ch-4)"],"\n      ",["<","var(--ch-4)"],["div","var(--ch-6)"]," ",["ref","var(--ch-2)"],["={","var(--ch-7)"],["container","var(--ch-4)"],["}","var(--ch-7)"]," ",["className","var(--ch-2)"],["=","var(--ch-7)"],["'h-72 break-words overflow-y-scroll'","var(--ch-8)"],["></","var(--ch-4)"],["div","var(--ch-6)"],[">","var(--ch-4)"],"\n    ",["</","var(--ch-4)"],["div","var(--ch-6)"],[">","var(--ch-4)"],"\n  ",[")","var(--ch-4)"],"\n",["}","var(--ch-4)"]],"annotations":[],"themeName":"github-from-css","style":{"color":"var(--ch-4)","background":"var(--ch-16)","colorScheme":"var(--ch-0)"}}]}]]}]}]
1b:T498,import Button from '@/components/ui/button'
import { useRef, useState } from 'react'

export default function Counter() {
  const container = useRef<any>(null)
  const [loopRunning, setLoop] = useState(false)
  const queue = useRef(Array.from({ length: 100000 }, () => performWorkUnit))

  function __click() {
    setLoop(true)
    requestIdleCallback(workLoop)
  }

  function performWorkUnit() {
    let span = document.createElement('span')
    span.innerText = '1'
    container.current.appendChild(span)
  }

  function workLoop() {
    if (queue.current.length === 0) {
      return setLoop(false)
    }
    requestIdleCallback(deadline => {
      let performWorkUnit: any;
      // 中断条件：没有剩余时间了
      while ((performWorkUnit = queue.current.pop()) && !deadline.didTimeout && deadline.timeRemaining() > 0) {
        performWorkUnit()
      }
      workLoop()
    })
  }

  return (
    <div className='space-y-4'>
      <Button danger disabled={loopRunning} onClick={__click}>{!loopRunning ? '插入 100 万个子节点' : '插入中...'}</Button>
      <div ref={container} className='h-72 break-words overflow-y-scroll'></div>
    </div>
  )
}1c:T498,import Button from '@/components/ui/button'
import { useRef, useState } from 'react'

export default function Counter() {
  const container = useRef<any>(null)
  const [loopRunning, setLoop] = useState(false)
  const queue = useRef(Array.from({ length: 100000 }, () => performWorkUnit))

  function __click() {
    setLoop(true)
    requestIdleCallback(workLoop)
  }

  function performWorkUnit() {
    let span = document.createElement('span')
    span.innerText = '1'
    container.current.appendChild(span)
  }

  function workLoop() {
    if (queue.current.length === 0) {
      return setLoop(false)
    }
    requestIdleCallback(deadline => {
      let performWorkUnit: any;
      // 中断条件：没有剩余时间了
      while ((performWorkUnit = queue.current.pop()) && !deadline.didTimeout && deadline.timeRemaining() > 0) {
        performWorkUnit()
      }
      workLoop()
    })
  }

  return (
    <div className='space-y-4'>
      <Button danger disabled={loopRunning} onClick={__click}>{!loopRunning ? '插入 100 万个子节点' : '插入中...'}</Button>
      <div ref={container} className='h-72 break-words overflow-y-scroll'></div>
    </div>
  )
}1d:T498,import Button from '@/components/ui/button'
import { useRef, useState } from 'react'

export default function Counter() {
  const container = useRef<any>(null)
  const [loopRunning, setLoop] = useState(false)
  const queue = useRef(Array.from({ length: 100000 }, () => performWorkUnit))

  function __click() {
    setLoop(true)
    requestIdleCallback(workLoop)
  }

  function performWorkUnit() {
    let span = document.createElement('span')
    span.innerText = '1'
    container.current.appendChild(span)
  }

  function workLoop() {
    if (queue.current.length === 0) {
      return setLoop(false)
    }
    requestIdleCallback(deadline => {
      let performWorkUnit: any;
      // 中断条件：没有剩余时间了
      while ((performWorkUnit = queue.current.pop()) && !deadline.didTimeout && deadline.timeRemaining() > 0) {
        performWorkUnit()
      }
      workLoop()
    })
  }

  return (
    <div className='space-y-4'>
      <Button danger disabled={loopRunning} onClick={__click}>{!loopRunning ? '插入 100 万个子节点' : '插入中...'}</Button>
      <div ref={container} className='h-72 break-words overflow-y-scroll'></div>
    </div>
  )
}10:["$","div",null,{"className":"code-tabs border rounded border-gray-200 overflow-hidden my-5","children":["$","$L18",null,{"children":[["$","$L19",null,{"tabs":[{"meta":"index.tsx -c","value":"$1b","lang":"tsx"}]}],["$","$L1a",null,{"highlighteds":[{"meta":"index.tsx -c","value":"$1c","lang":"tsx","code":"$1d","tokens":[["import","var(--ch-7)"]," ",["Button","var(--ch-4)"]," ",["from","var(--ch-7)"]," ",["'@/components/ui/button'","var(--ch-8)"],"\n",["import","var(--ch-7)"]," ",["{ useRef, useState }","var(--ch-4)"]," ",["from","var(--ch-7)"]," ",["'react'","var(--ch-8)"],"\n\n",["export default function","var(--ch-7)"]," ",["Counter","var(--ch-5)"],["()","var(--ch-3)"]," ",["{","var(--ch-4)"],"\n  ",["const","var(--ch-7)"]," ",["container","var(--ch-2)"]," ",["=","var(--ch-7)"]," ",["useRef","var(--ch-5)"],["<","var(--ch-4)"],["any","var(--ch-2)"],[">(","var(--ch-4)"],["null","var(--ch-2)"],[")","var(--ch-4)"],"\n  ",["const","var(--ch-7)"]," ",["[","var(--ch-4)"],["loopRunning","var(--ch-2)"],[",","var(--ch-4)"]," ",["setLoop","var(--ch-2)"],["]","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["useState","var(--ch-5)"],["(","var(--ch-4)"],["false","var(--ch-2)"],[")","var(--ch-4)"],"\n  ",["const","var(--ch-7)"]," ",["queue","var(--ch-2)"]," ",["=","var(--ch-7)"]," ",["useRef","var(--ch-5)"],["(Array.","var(--ch-4)"],["from","var(--ch-5)"],["({ length:","var(--ch-4)"]," ",["100000","var(--ch-2)"]," ",["}, ()","var(--ch-4)"]," ",["=>","var(--ch-7)"]," ",["performWorkUnit))","var(--ch-4)"],"\n\n  ",["function","var(--ch-7)"]," ",["__click","var(--ch-5)"],["() {","var(--ch-4)"],"\n    ",["setLoop","var(--ch-5)"],["(","var(--ch-4)"],["true","var(--ch-2)"],[")","var(--ch-4)"],"\n    ",["requestIdleCallback","var(--ch-5)"],["(workLoop)","var(--ch-4)"],"\n  ",["}","var(--ch-4)"],"\n\n  ",["function","var(--ch-7)"]," ",["performWorkUnit","var(--ch-5)"],["() {","var(--ch-4)"],"\n    ",["let","var(--ch-7)"]," ",["span","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["document.","var(--ch-4)"],["createElement","var(--ch-5)"],["(","var(--ch-4)"],["'span'","var(--ch-8)"],[")","var(--ch-4)"],"\n    ",["span.innerText","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["'1'","var(--ch-8)"],"\n    ",["container.current.","var(--ch-4)"],["appendChild","var(--ch-5)"],["(span)","var(--ch-4)"],"\n  ",["}","var(--ch-4)"],"\n\n  ",["function","var(--ch-7)"]," ",["workLoop","var(--ch-5)"],["() {","var(--ch-4)"],"\n    ",["if","var(--ch-7)"]," ",["(queue.current.","var(--ch-4)"],["length","var(--ch-2)"]," ",["===","var(--ch-7)"]," ",["0","var(--ch-2)"],[") {","var(--ch-4)"],"\n      ",["return","var(--ch-7)"]," ",["setLoop","var(--ch-5)"],["(","var(--ch-4)"],["false","var(--ch-2)"],[")","var(--ch-4)"],"\n    ",["}","var(--ch-4)"],"\n    ",["requestIdleCallback","var(--ch-5)"],["(","var(--ch-4)"],["deadline","var(--ch-3)"]," ",["=>","var(--ch-7)"]," ",["{","var(--ch-4)"],"\n      ",["let","var(--ch-7)"]," ",["performWorkUnit","var(--ch-4)"],[":","var(--ch-7)"]," ",["any","var(--ch-2)"],[";","var(--ch-4)"],"\n      ",["// 中断条件：没有剩余时间了","var(--ch-1)"],"\n      ",["while","var(--ch-7)"]," ",["((performWorkUnit","var(--ch-4)"]," ",["=","var(--ch-7)"]," ",["queue.current.","var(--ch-4)"],["pop","var(--ch-5)"],["())","var(--ch-4)"]," ",["&& !","var(--ch-7)"],["deadline.didTimeout","var(--ch-4)"]," ",["&&","var(--ch-7)"]," ",["deadline.","var(--ch-4)"],["timeRemaining","var(--ch-5)"],["()","var(--ch-4)"]," ",[">","var(--ch-7)"]," ",["0","var(--ch-2)"],[") {","var(--ch-4)"],"\n        ",["performWorkUnit","var(--ch-5)"],["()","var(--ch-4)"],"\n      ",["}","var(--ch-4)"],"\n      ",["workLoop","var(--ch-5)"],["()","var(--ch-4)"],"\n    ",["})","var(--ch-4)"],"\n  ",["}","var(--ch-4)"],"\n\n  ",["return","var(--ch-7)"]," ",["(","var(--ch-4)"],"\n    ",["<","var(--ch-4)"],["div","var(--ch-6)"]," ",["className","var(--ch-2)"],["=","var(--ch-7)"],["'space-y-4'","var(--ch-8)"],[">","var(--ch-4)"],"\n      ",["<","var(--ch-4)"],["Button","var(--ch-6)"]," ",["danger disabled","var(--ch-2)"],["={","var(--ch-7)"],["loopRunning","var(--ch-4)"],["}","var(--ch-7)"]," ",["onClick","var(--ch-2)"],["={","var(--ch-7)"],["__click","var(--ch-4)"],["}","var(--ch-7)"],[">","var(--ch-4)"],["{!","var(--ch-7)"],["loopRunning","var(--ch-4)"]," ",["?","var(--ch-7)"]," ",["'插入 100 万个子节点'","var(--ch-8)"]," ",[":","var(--ch-7)"]," ",["'插入中...'","var(--ch-8)"],["}","var(--ch-7)"],["</","var(--ch-4)"],["Button","var(--ch-6)"],[">","var(--ch-4)"],"\n      ",["<","var(--ch-4)"],["div","var(--ch-6)"]," ",["ref","var(--ch-2)"],["={","var(--ch-7)"],["container","var(--ch-4)"],["}","var(--ch-7)"]," ",["className","var(--ch-2)"],["=","var(--ch-7)"],["'h-72 break-words overflow-y-scroll'","var(--ch-8)"],["></","var(--ch-4)"],["div","var(--ch-6)"],[">","var(--ch-4)"],"\n    ",["</","var(--ch-4)"],["div","var(--ch-6)"],[">","var(--ch-4)"],"\n  ",[")","var(--ch-4)"],"\n",["}","var(--ch-4)"]],"annotations":[],"themeName":"github-from-css","style":{"color":"var(--ch-4)","background":"var(--ch-16)","colorScheme":"var(--ch-0)"}}]}]]}]}]
16:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
14:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"usehook - 前端顶级精英俱乐部"}],["$","meta","2",{"name":"description","content":"最好的前端学习网站, react, react19, react hooks, zustand"}],["$","meta","3",{"name":"author","content":"这波能反杀"}],["$","meta","4",{"name":"keywords","content":"react, react19, react hooks, zustand"}],["$","link","5",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
12:null
